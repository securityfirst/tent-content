[Title]: # ()
[Order]: # (0)

# PGP FOR MAC OSX 工具指南

## PGP for Mac OSX 工具指南
为Mac加密的电子邮件

**课程阅读：**
- [电子邮件](伞：//课程/电子邮件) 
**下载位置：** 
- [GPG Suite](https://gpgtools.org/)
- [Mozilla Thunderbird](https://www.mozilla.org/thunderbird/) 
- [Enigmail](https://www.enigmail.net/home/index.php)  
**计算机要求：** 互联网连接，运行Mac OS X的计算机，电子邮件帐户  
**本指南中使用的版本：** 
- GPG Suite Beta 4 
- Mozilla Thunderbird 31.2.0 
- Enigmail 1.7.2   
**许可证：** 免费软件;自由软件许可证的混合
**级别：** 高级  
**其他阅读：** [http://support.gpgtools.org/](http://support.gpgtools.org/)  
**所需时间：** 30-60分钟

**使用PGP将为您提供：** 
- 保护您的电子邮件通讯不被任何人阅读，但他们的目标收件人除外。 
- 能够证明电子邮件来自某个特定的人，而不是由另一个发件人发送的假消息（否则电子邮件很容易被伪造)。这些都是重要的防御措施，如果您是针对监控或错误信息。

### 1.0开始之前

要使用Pretty Good Privacy（PGP)，您需要安装一些额外的软件使用您当前的电子邮件程序。您还需要创建一个私人密钥，您将保密。私钥用于解密发送给您的电子邮件，并对您发送的电子邮件进行数字签名，以显示它们确实来自您。最后，您将学习如何分发您的公钥 - 其中一小部分信息是其他人在向您发送加密邮件之前需要知道的信息，并且可用于验证您发送的电子邮件。

本指南将显示您可以通过Mac内置的Mail程序或Mozilla Thunderbird（一种流行的替代电子邮件程序)，与Apple Mac（但不包括iPad或iPhone)一起使用PGP。

您目前无法直接使用PGP Gmail，Hotmail，Yahoo!等网页电子邮件服务。邮件或Outlook Live。您仍然可以使用您的网络邮件地址;您只需在计算机上使用Thunderbird程序对其进行配置。

**请注意，电子邮件对话的两端都需要使用PGP兼容软件才能正常工作。** 

人们将通常只在他们自己的个人设备上使用，而不是在共享设备上使用。幸运的是，PGP可用于大多数台式电脑和移动设备，您可以将它们指向这些指南以帮助他们设置自己的版本。本指南适用于Mac用户。

### 2.0在Mac上安装GPGTools 

PGP是一个开放标准，这意味着多个软件可以使用它。我们将用于PGP的软件称为GPG套件，来自GPG Tools，因为它可以在Mac上使用，任何人都可以免费使用，而且它是开源的：底层的源代码可供任何人检查错误和后门程序。

安装GPG Suite后，您可以首次设置密钥，然后在Apple Mail和Thunderbird上启用PGP。

**第1步：安装程序。** 

首先，在您的浏览器中转到[https://www.gpgtools.org/](https://www.gpgtools.org/) 并选择\“Download GPG Suite 
![image](tool_pgposx1.png)

您将得到一个磁盘映像，您可以点击它来安装该软件。如果您不习惯在计算机上安装第三方软件，请向附近的Mac专家咨询 - 是大多数技术人员可以帮助您的一步，即使他们不知道PGP或加密。
![image](tool_pgposx2.png)

单击安装会为您提供将添加到你的电脑。
![image](tool_pgposx3.png)

**_我究竟在什么安装在这里？_** 

这些工具将主要在幕后工作，以便Mac上的多个程序可以使用PGP。把它们想象成其他程序可以使用的程序，而不是直接使用的应用程序。 GPGMail允许Apple Mail发送和阅读PGP电子邮件，GPG Keychain Access允许您以保存其他密码的方式保存您的私钥和公钥。

GPGServices可选地向OS X添加一项功能以供您使用PGP直接在电子邮件以外的程序中（例如，在文字处理器中)。 GPGPreferences用于在Apple的偏好设置中更改PGP设置。最后，MacGPG2是任何程序需要用来进行加密或签名的基本工具。

 2014年10月，GPG工具团队宣布他们很快将对GPGMail收费，GPGMail是他们软件包的一部分，可让您使用GPG与苹果的邮件应用程序。本教程是关于在Thunderbird中使用GPG，因此它不使用该组件。如果您愿意，您可以使用GPG套件的零成本部分，如此处所述。这个选项带来的额外好处是，所有这些工具都是“免费软件”，这意味着您仍然可以自由检查，编辑和重新分配GPG Mail的底层源代码，因此它们更加安全。有关更多信息，请参阅GPG工具的[自己的常见问题](https://gpgtools.org/news.html)。 

单击“继续”安装GPG套件。
![image](tool_pgposx4.png)

安装完成后，如果GPG钥匙串没有运行，请打开GPG钥匙串t会自动打开并提示您在安装后生成PGP密钥。 
![image](tool_pgposx5.png)

**步骤2：创建您的PGP密钥** 

有时当您安装新软件时，您的计算机会用没有明显答案的问题来纠缠你，而实际上却没有给你任何关于如何回复的建议。这是其中一次。

重要的是花一点时间思考您在此给出的答案，因为稍后更改您的PGP密钥细节可能很困难，并且如果您选择在某处发布密钥，您将无法取消发布。（从1990年代起，仍然有成千上万的旧密钥随着人们的姓名和旧电子邮件地址而变化。)

PGP密钥包含一个名称和一个将密钥链接到您的电子邮件地址。电子邮件地址是其他人可以在向您加密邮件时发现使用哪个密钥的方式之一。

**_何时不应将我的真实姓名或电子邮件地址放在我的PGP密钥上？什么时候不应该上传我的密钥？_** 

对于大多数人来说，为密钥添加一个真实的电子邮件地址并将其上传到公钥服务器是有意义的 - 这就是人们如何将正确的密钥与您匹配。他们可以直接向您发送电子邮件，并知道将使用正确的密钥进行加密，并且当他们收到您签名的电子邮件时，数字签名将标有您的姓名。

但对于某些人，它会将真实姓名添加到密钥上是没有意义的，例如，如果您的威胁模型意味着将您的身份公开地添加到密钥（和链接的电子邮件地址)不是一个好主意。在他透露自己的身份之前，爱德华斯诺登与使用PGP和匿名电子邮件地址的记者进行了沟通;他的PGP密钥肯定没有用他的名字标记。

**上传密钥是正常的做法，但它可以显示您正在使用加密，即使您不使用自己的名字。另外，正如我们将看到的，其他人可能会上传您的密钥并将其与自己的密钥相关联，这意味着您和他们有联系。如果你正在交流并且不希望别人知道这件事，这可能是有害的。如果你没有交流，也可能很麻烦，但是你的攻击者希望人们认为你是相关的。** 这是一个粗略的指导方针：如果你一般在考虑使用假名，那么使用假名（和替代电子邮件)标记您的密钥。如果您处于更危险的环境中，当您不想让人们知道您使用PGP或知道您与谁进行通信时，请勿将密钥上传至公钥服务器 - 并确保小型你与之沟通的一群人知道不要上传你的钥匙。还有其他一些验证密钥的方法，这些方法不依赖公钥服务器提供的密钥 - 请参阅EFF的指南[密钥验证](https://ssd.eff.org/en/module/key-verification#overlay=n/node/37/)以获取更多信息。

如果您希望让其他人快速找到您的密钥，以便他们能够向您发送加密消息，请单击“上传后再上传公钥”框。这就像是将您的电话号码添加到公共电话目录中：您不需要它，但这对其他人很方便。

在生成密钥之前，请展开“高级选项”。您可以将注释留空，然后离开密钥类型“RSA和RSA（默认)”但请确保将长度字段更改为4096. 
![image](tool_pgposx6.png)

**您的密钥将在某个时间到期;当发生这种情况时，其他人将不再使用它来完全发送给你的新邮件，尽管你可能没有得到任何关于原因的警告或解释。因此，您可能希望标记日历，并在到期日期前一个月左右注意此问题。** 

可以通过为现有密钥提供一个新的过期日期来延长其使用期限，或者可以通过从头开始创建一个新密钥来替换它。这两个流程都可能需要联系向您发送电子邮件的人员，并确保他们获得更新的密钥;目前的软件并不擅长自动化。所以请提醒你自己;如果你不认为自己能够管理它，那么你可以考虑设置密钥以便它永不过期，尽管在这种情况下，其他人可能会在将来与你联系时尝试使用它，即使你不再有私钥或不再使用PGP。

当您准备好时，请点击“生成密钥”按钮。

您的计算机将开始生成公钥和私钥。完成时间不应该超过几分钟（这需要一段时间，因为要创建您的密钥，您的计算机需要收集随机数字。将其视为您的计算机会多次，多次地掷出一对骰子。)
![image](tool_pgposx7.png)

当您完成密钥生成时，您会看到GPG Keychain Access中列出的密钥。您可以双击密钥以查看有关密钥的信息，包括它的“fingerprint” - 一种识别您的PGP密钥的独特方式。

现在是生成撤销证书的好时机。（撤销证书是一个文件，您可以生成该文件，宣布您不再信任该密钥，当您仍然拥有密钥时生成该密钥，并将其保留用于将来的任何灾难。)将来，如果您担心您的私钥已被某人复制，您意外删除或丢失了您的私钥，或者您忘记了密码，可以通过使用吊销证书告诉所有人它已被吊销或取消。 

现在创建一个更好，因为您需要私钥和密码来创建撤销证书。如果你把它留到以后，你可能会失去一个或另一个，然后就太迟了。因此，通过点击您的密钥，选择“Key ”菜单条目，然后“创建吊销证书”来创建证书。系统会提示您在某处保存文件。您可能希望保留该密钥的备份副本（请参阅下一步)。

**第3步：备份您的PGP密钥** 

如果您失去对私钥的访问权限，无法解密任何传入的PGP邮件或您的旧邮件。另一方面，您希望尽可能安全地保留您的私钥。

您可能希望将备份副本保存到USB密钥中，并将其保密。如果您丢失了原始密钥，您只需要它，但为了安全起见，您不希望将其从潜在攻击者的手中移除。

**_如果攻击者获得我的PGP私钥，一切都会丢失吗？_** 

如果您的Mac被盗，或者您的备份密钥已被盗取？这是否意味着你的PGP信息是脆弱的？否：如果您选择了一个好的密码并且没有人能够知道它是什么，那么您仍然应该受到大部分保护。为了安全起见，您可能需要撤销旧密钥，并创建一个新的PGP密钥。这不会阻止您的旧密钥解密您的旧电子邮件，但它会阻止其他人将旧密钥用于他们的新电子邮件。

 
要备份密钥，请打开GPG密钥链访问。选择您的密钥，然后单击工具栏中的“导出”。将USB驱动器放入机器，然后在“另存为...”对话框的“Where”部分中选择它。检查“允许密钥导出”复选框。

**选项A) 配置 Apple Mail**

当您第一次打开Apple Mail时，您会看到第一个运行向导，可帮助您设置您的电子邮件地址。填写您的姓名，电子邮件地址和您的电子邮件密码，然后单击“创建。”
![image](tool_pgposx8.png)

**邮件帐户设置向导** 

如果您使用流行Gmail等免费电子邮件服务，当您点击继续时，Mail应该能够自动检测您的电子邮件设置。如果没有，您可能需要手动配置您的IMAP和SMTP设置。与您使用电子邮件的公司联系，或询问熟悉您的电子邮件提供商的技术人员（所以，工作中的IT人员或与您使用相同ISP的技术人员，他们不需要了解PGP ，但你可以问他们“你可以为我设置Apple Mail吗？”)。
![image](tool_pgposx9.png)

**邮件帐户设置自动检测** 

当您撰写新邮件时，主题字段下方会显示两个图标。有一个挂锁（加密电子邮件)和一个明星（数字签名电子邮件)。如果挂锁已关闭，则意味着此电子邮件将被加密，如果明星已签入，则表示此电子邮件将进行数字签名。

 
**发送PGP签名或加密电子邮件** 
 ![image](tool_pgposx10.png)

即使收件人不使用PGP，您也可以随时在电子邮件上签名。由于数字签名电子邮件需要您的密钥，因此Mail会在您首次签署电子邮件时弹出一个窗口询问您的密码。

如果您通过电子邮件发送的人使用PGP并且您拥有该人的公钥，则只能对电子邮件进行加密。如果加密挂锁图标被解锁并变灰，所以您无法点击它，这意味着您首先需要导入收件人的公钥。请求他们发送给您，或者使用GPG Keychain Access应用程序从公钥服务器中找到密钥。

要绝对安全，您需要验证您从密钥服务器或您的同事获得的密钥。有关更多信息，请参阅EFF的指南[密钥验证](https://ssd.eff.org/en/module/key-verification#overlay=en/node/37/)。

**选项B) 使用PGP与 Mozilla Thunderbird**

本演练演示如何将GPG与来自Mozilla的免费开源Thunderbird邮件客户端一起使用，以及用于电子邮件加密的Enigmail插件。

首先，从[https：/ / /www.mozilla.org/thunderbird](https://www.mozilla.org/thunderbird) ，像使用GPG Tools一样安装磁盘映像，然后将Thunderbird拖放到应用程序中。当你第一次打开时，它会询问你是否想将它设置为默认的电子邮件客户端。继续并单击“设置为默认值”。
![image](tool_pgposx11.png)

然后您将看到第一个运行向导。要设置您的现有电子邮件地址，请点击“跳过此并使用我现有的电子邮件。”然后在您的电子邮件帐户中输入您的姓名，电子邮件地址和密码。
![image](tool_pgposx12.png)

如果您使用Gmail等流行的免费电子邮件服务，则当您单击继续时，Thunderbird应该能够自动检测您的电子邮件设置。如果没有，您可能需要手动配置您的IMAP和SMTP设置 - 请询问您的ISP或知道设置电子邮件的技术朋友以获取帮助。有时，Thunderbird只能猜出正确的设置。

**如果您对Google使用双因素身份验证（并且取决于您的威胁模型，您可能应该！)，因此无法在Thunderbird中使用标准Gmail密码。相反，您需要为Thunderbird创建一个新的应用程序专用密码才能访问您的Gmail帐户。请参阅[Google自己的指南](https://support.google.com/mail/answer/1173270?hl=zh-CN)。** 
![image](tool_pgposx13.png)

在“重新配置Thunderbird来检查你的电子邮件，点击“完成”。然后点击左上角的“收件箱”加载你的电子邮件。

现在你已经安装并配置了Thunderbird来处理你的电子邮件，您需要安装Thunderbird的GPG附件[Enigmail](https://www.enigmail.net/home/index.php)。在Thunderbird中，点击右上角的菜单图标，然后选择附加组件。
![image](tool_pgposx14.png)

在右上角的搜索框中搜索enigmail 
![image](tool_pgposx15.png)

点击Enigmail扩展旁边的安装按钮下载并安装Enigmail。完成后，单击“立即重新启动”以重新启动Thunderbird。

首次运行启用Enigmail的Thunderbird时，将打开OpenPGP安装向导。 

请点击菜单按钮，将鼠标悬停在首选项上，然后选择帐户设置。
![image](tool_pgposx16.png)

转到OpenPGP安全性标签。确保选中“为此标识启用OpenPGP支持（Enigmail)”。“使用特定的OpenPGP密钥ID”应该被选中，如果你的密钥没有被选中，你可以点击“选择密钥”来选择它。

你还应该检查“默认情况下，“”默认情况下对加密邮件进行签名“和”默认使用PGP/MIME“，但不是（对大多数人)”默认加密邮件“

如果大多数人你的电子邮件使用PGP（或者你想鼓励他们这样做)，你可能希望默认进行加密。加密您发送的所有电子邮件将是理想的，但这并非总是可行。请记住，您只能将加密电子邮件发送给使用PGP的其他人，并且您需要将公钥存储在钥匙串中。 
![image](tool_pgposx17.png)

然后点击“确定”保存所有的设置。

恭喜，您可以通过手动选择加密您发送的每封电子邮件，你现在已经成立了Thunderbird和Enigmail！以下是一些快速指示器：

- 您可以单击菜单按钮，将鼠标悬停在OpenPGP上，然后打开密钥管理以查看内置于Enigmail的PGP密钥管理器。这与GPG Keychain Access非常相似，您可以选择使用它。 
- 当您撰写新消息时，窗口右下角有两个图标：一支笔（数字签名电子邮件)和一个密钥（加密电子邮件)。如果图标是黄金，则表示它们已被选中，如果它们是银色，则表示它们未被选中。点击它们来切换签名和加密您正在撰写的电子邮件。
![image](tool_pgposx18.png)
